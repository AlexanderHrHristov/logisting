{% extends "base.html" %}
{% block content %}

<h2 class="mb-4" style="color: white; font-weight: bold;">üöö –ì—Ä–∞—Ñ–∏–∫ –∑–∞ –≤–∑–µ–º–∞–Ω–µ –Ω–∞ —Å—Ç–æ–∫–∏ –æ—Ç –≤—ä–Ω—à–Ω–∏ —Å–ø–µ–¥–∏—Ü–∏–∏</h2>


    <div class="container mt-4">

    <a href="{% url 'suppliers:pickup_create' %}" class="btn btn-primary mt-3">‚ûï –î–æ–±–∞–≤–∏ –Ω–æ–≤–∞ –¥–æ—Å—Ç–∞–≤–∫–∞</a>

        <!-- Filters -->
        <form method="get" class="row g-2 mb-3">
            <div class="col-auto">
                <label for="date" class="form-label">–î–∞—Ç–∞</label>
                <select id="date" name="date" class="form-select">
                    <option value="" {% if not request.GET.date %}selected{% endif %}>–í—Å–∏—á–∫–∏</option>
                    {% for day in workdays %}
                        <option value="{{ day|date:'Y-m-d' }}" {% if request.GET.date == day|date:'Y-m-d' %}selected{% endif %}>
                            {{ day|date:"d F Y" }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-auto">
                <label for="supplier" class="form-label">–î–æ—Å—Ç–∞–≤—á–∏–∫</label>
                <select id="supplier" name="supplier" class="form-select">
                    <option value="" {% if not request.GET.supplier %}selected{% endif %}>–í—Å–∏—á–∫–∏</option>
                    {% for supplier in suppliers %}
                        <option value="{{ supplier.id }}" {% if request.GET.supplier == supplier.id|stringformat:"s" %}selected{% endif %}>
                            {{ supplier.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-auto align-self-end">
                <button type="submit" class="btn btn-primary">–ü–æ–∫–∞–∂–∏</button>
            </div>
        </form>

        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–î–æ—Å—Ç–∞–≤—á–∏–∫</th>
                        <th>–û–±–µ–º (–ø–∞–ª–µ—Ç–∏)</th>
                        <th>–¢–µ—Ä–º–æ–ª–∞–±–∏–ª–Ω–∏</th>
                        <th>–ù–∞—Ä–∫–æ—Ç–∏—á–Ω–∏</th>
                        <th>–ë–µ–ª–µ–∂–∫–∞</th>
                        <th class="text-center">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% if schedules_by_day %}
                        {% for day, day_schedules in schedules_by_day.items %}
                            {% for schedule in day_schedules %}
                                <tr>
                                    {% if forloop.first %}
                                        <td rowspan="{{ day_schedules|length }}">{{ day|date:"d.m.Y" }}</td>
                                    {% endif %}
                                    <td>{{ schedule.supplier.name }}</td>
                                    <td>{{ schedule.volume }}</td>
                                    <td>{{ schedule.thermolabile|yesno:"–î–∞,–ù–µ" }}</td>
                                    <td>{{ schedule.narcotic|yesno:"–î–∞,–ù–µ" }}</td>
                                    <td>{{ schedule.note|default:"-" }}</td>
                                    <td class="text-center">
                                        <a href="{% url 'suppliers:pickup_schedule_edit' schedule.pk %}" class="btn btn-sm btn-warning">–†–µ–¥–∞–∫—Ç–∏—Ä–∞–π</a>
                                        <a href="{% url 'suppliers:pickup_delete' schedule.pk %}" class="btn btn-sm btn-danger">–ò–∑—Ç—Ä–∏–π</a>
                                    </td>
                                </tr>
                            {% endfor %}
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="7" class="text-center text-muted">–ù—è–º–∞ –≤–∑–µ–º–∞–Ω–∏—è</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>




    </div>
    {% endblock %}
