{% extends "base.html" %}

{% block content %}

<h1>DEBUG Suppliers:</h1>
<ul>
    {% for s in suppliers %}
        <li>{{ s.name }} (active: {{ s.is_active }})</li>
    {% empty %}
        <li>НЯМА ДОСТАВЧИЦИ В QuerySet</li>
    {% endfor %}
</ul>


    <div class="container mt-4">
        <h2 class="mb-4">Доставчици</h2>

        <h2 class="mb-4">Доставчици</h2>
    <p>Намерени доставчици: {{ suppliers|length }}</p>

        {% if suppliers %}
            <p>Общо доставчици: {{ suppliers|length }}</p>
        {% else %}
            <p>Няма намерени доставчици.</p>
        {% endif %}


        {% if user.is_authenticated %}
            {% if user.is_logistic or user.is_logistics_manager %}
                <div class="mb-3 text-end">
                    <a href="{% url 'add_supplier' %}" class="btn btn-primary">Добави нов доставчик</a>
                </div>
            {% endif %}
        {% endif %}

    <div class="table-responsive">
        <table class="table table-striped table-bordered table-hover table-sm align-middle">
            <thead class="table-light">
                <tr>
                    <th scope="col">Доставчик</th>
                    <th scope="col">Имейл</th>
                    <th scope="col">Телефон</th>
                    <th scope="col">Лице за контакт</th>
                    <th scope="col">Доставя?</th>
                    <th scope="col">Отговорен логистик</th>
                    <th scope="col">Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for supplier in suppliers %}
                    <tr>
                        <td>{{ supplier.name }}</td>
                        <td>{{ supplier.email }}</td>
                        <td>{{ supplier.phone }}</td>
                        <td>{{ supplier.contact_person }}</td>
                        <td>{{ supplier.get_delivers_to_us_display }}</td>
                        <td>{% if supplier.responsible_logistic %}{{ supplier.responsible_logistic.get_full_name }}{% else %}-{% endif %}</td>
                        <td>
                            {% if user.is_authenticated %}
                                {% if user.is_logistic or user.is_logistics_manager %}
                                    <a href="{% url 'edit_supplier' supplier.pk %}" class="btn btn-sm btn-warning">Редактирай</a>
                                    <a href="{% url 'delete_supplier' supplier.pk %}" class="btn btn-sm btn-danger" onclick="return confirm('Сигурни ли сте, че искате да изтриете този доставчик?');">Изтрий</a>
                                {% endif %}
                            {% endif %}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="7" class="text-center">Няма добавени доставчици.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>


{% endblock %}